<html>
  <head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <!-- <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script> -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="https://unpkg.com/aframe-transparent-video-shader@1.0.3/dist/aframe-transparent-video-shader.umd.js"></script>
    <script src="https://unpkg.com/aframe-chromakey-material/dist/aframe-chromakey-material.min.js"></script>
    <!-- <script>
      AFRAME.registerComponent("foo", {
        init: function() {
          this.el.addEventListener("materialtextureloaded", e => {
            let material = this.el.getObject3D("mesh").material;
						material.map.format = THREE.RGBAFormat;
            material.map.needsUpdate = true;
          });
        }
      });
    </script> -->
    <!-- <script>
      AFRAME.registerComponent("playVideo", {
        init: function() {
          this.el.addEventListener("materialtextureloaded", e => {
            var videoEl = this.el.getAttribute('material').src;
            if (!videoEl) { return; }
            this.el.object3D.visible = true;
            videoEl.play();
          });
        }
      });
    </script> -->
  </head>
  <body>
    <a-scene 
    renderer="logarithmicDepthBuffer: true;"
    embedded 
    arjs='sourceType: webcam;' 
    vr-mode-ui="enabled: false">
      <a-assets>
        <video id="alpha1" src="https://cdn.glitch.com/e3796de4-705d-4b33-a77c-084a0b428d27%2FAlphaTestVideo.webm?1552438409173" muted autoplay loop="true" playsinline webkit-playsinline></video>
        <video id="alpha2" loop="true" src="https://arjs-cors-proxy.herokuapp.com/https://ataylor32.github.io/demo-html5-transparent-video/video.webm" autoplay muted playsinline webkit-playsinline></video>
        <video id="alpha3" loop="true" src="./asset/AlphaTestVideo.webm" autoplay muted playsinline webkit-playsinline></video>
        <video id="greenScreen" src="./asset/example.mp4" muted autoplay loop="true" playsinline webkit-playsinline></video>
        <video id="greenScreen2" src="https://cdn.glitch.com/386b4b78-f38f-4631-93b4-9ea2a834b6bd/greenScreenTest.mp4" muted autoplay loop="true" playsinline webkit-playsinline></video>
        <video id="greenScreen3" src="./asset/greenScreenTest.mp4" muted autoplay loop="true" playsinline webkit-playsinline></video>
      </a-assets>

      <!-- <a-entity
        material="shader: transparent-video; src: #testVideo"
        geometry="primitive: plane;
                  width: 1;
                  height: 1.8"
        position="0 1 0">
      </a-entity> -->

      <!-- <a-marker id = "marker1" preset='hiro'>
      
        <a-plane
            position="0 0.5 0"
            material="shader: transparent-video; src: #alpha1"
        ></a-plane>
        <a-plane
          position="1 0.5 0"
          material="shader: transparent-video; src: #alpha2"
        ></a-plane>     
        <a-plane
            position="-1 0.5 0"
            material="shader: chromakey; src: #greenScreen; color: 0.1 0.9 0.2" 
            height="1.92" width="1.08"          
        ></a-plane>
        <a-plane
          position="-3 0.5 0"
          width="1.92"
          height="1.08"
          material="shader: chromakey; src: #greenScreen2; color: 0.1 0.9 0.2" 
        ></a-plane>       
        
        <a-plane
          position="-3 0.5 0"
          material="shader: transparent-video; src: #alpha3" 
        ></a-plane>

        <a-plane
          position="-5 0.5 0"
          width="1.92"
          height="1.08"
          material="shader: chromakey; src: #greenScreen3; color: 0.1 0.9 0.2" 
        ></a-plane> 
      </a-marker> -->

      <!-- <a-marker id ="marker2" type='pattern' url='./asset/pattern-arjs3-image-tracking.patt'>
        <a-plane
          position="0 0.5 0"
          width="1.92"
          height="1.08"
          material="shader: chromakey; src: #greenScreen2;" 
        ></a-plane>
        <a-plane
          position="-1 0.5 0"
          width="1.92"
          height="1.08"
          material="shader: chromakey; src: #greenScreen3; color: 0.1 0.9 0.2" 
        ></a-plane>
        <a-plane
            position="1 0.5 0"
            material="shader: chromakey; src: #greenScreen; color: 0.1 0.9 0.2" 
            height="1.92" width="1.08"          
        ></a-plane>
      </a-marker>     -->

      <a-nft
        type="nft"
        url="asset/imageTracking/dino"
        smooth="true"
        smoothCount="10"
        smoothTolerance=".01"
        smoothThreshold="5"
      >
      <a-entity
          gltf-model="https://arjs-cors-proxy.herokuapp.com/https://raw.githack.com/AR-js-org/AR.js/master/aframe/examples/image-tracking/nft/trex/scene.gltf"
              scale="5 5 5"
              position="100 100 0"
          >
          </a-entity>
      </a-nft>   
      <a-entity camera></a-entity>
    </a-scene>

    <script type="text/javascript">
      // const sceneEl = document.querySelector("a-scene");
      // sceneEl.addEventListener("loaded", () => {
      //   sceneEl.camera = new THREE.PerspectiveCamera();
      // });
  
      // let nftElem = document.querySelector("a-nft");
  
      // nftElem.addEventListener("markerFound", (e) => {
      //   document.getElementById("scannerContainer").style.display = "none";
      //   document.getElementById("imgContainer").style.display = "none";
      //   console.log("found");
      // });
  
      // nftElem.addEventListener("markerLost", (e) => {
      //   document.getElementById("scannerContainer").style.display = "";
      //   document.getElementById("imgContainer").style.display = "";
      //   console.log("lost");
      // }); 

      // document.querySelector('a-scene').addEventListener('loaded', function () {                       
      //   document.getElementById('alpha1').play();
      //   document.getElementById('alpha2').play();                                                                     
      //   console.log("loaded");
      // })

      // let markerElem = document.getElementById("marker1");
      // markerElem.addEventListener("markerFound", (e) => {
      //   document.getElementById('alpha1').play();
      //   document.getElementById('alpha2').play();
      //   document.getElementById('greenScreen').play();
      //   document.getElementById('greenScreen2').play();
      //   document.getElementById('greenScreen3').play();
      //   console.log("found");
      // });
      // markerElem.addEventListener("markerLost", (e) => {      
      //   console.log("lost");
      // }); 


      // let marker2Elem = document.getElementById("marker2");
      // marker2Elem.addEventListener("markerFound", (e) => {
      //   document.getElementById('greenScreen2').play();
      //   document.getElementById('greenScreen3').play();
      //   document.getElementById('greenScreen').play();
      //   console.log("found");
      // });
  
    </script>

    <!-- <a-scene>
      <a-box position="-1 0.5 -3" rotation="0 45 0" color="#4CC3D9"></a-box>
      <a-sphere position="0 1.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
      <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
      <a-sky color="#ECECEC"></a-sky>
    </a-scene> -->
    </body>
</html>